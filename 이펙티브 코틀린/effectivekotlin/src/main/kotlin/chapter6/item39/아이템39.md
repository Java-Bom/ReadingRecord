# Item39. 태그 클래스 보다는 클래스 계층을 사용하라

태그 클래스(tagged class) : 하나의 클래스에 Enum타입, 상수, 각 태그별 필드, 분기 코드 등을 포함한 클래스

- 한 클래스에 여러 모드를 처리하기 위한 상용구(boilerplate)가 추가된다.
- 여러 목적으로 사용해야해 프로퍼티가 일관적이지 않다.
- 객체가 제대로 생성됐는지 여부 확인을 위해 팩토리 메서드를 사용해야하는 경우가 많다.

해결 : 클래스 **계층 구조**로 변경한다. : 코틀린에서는 sealed 클래스를 많이 사용한다.

한 클래스에 여러 모드를 만드는 방법 대신에, 각각의 모드를 여러 클래스로 만들고 타입 시스템과 다형성을 활용한다.



### Sealed 한정자

sealed한정자 : 외부 파일에서 서브 클래스를 만드는 행위 자체를 제한한다.

외부에서 추가적인 서브클래스를 만들 수 없다. (타입이 추가되지 않을 것이 보장된다.)

when 사용시 서브클래스별 분기를 만들 때 else 선언이 필요가 없다.



클래스의 서브클래스 제어 : sealed 한정자 / 상속과 관련한 설계 : abstract



### 상태 패턴

상태패턴 : 객체의 내부 상태가 변화할 때, 객체의 동작이 변화는 소프트웨어 디자인

MVC, MVP, MVVM 등과 같은 설계시 사용된다.

상태 패턴을 사용하면 서로 다른 상태를 나타내는 클래스 계층 구조를 만들게 된다.

- 상태는 더 많은 책임을 가진 클래스이다.
- 상태는 변경할 수 있다.

구체 상태(concrete state)는

- 객체를 활용해서 표현하는 것이 일반적
- 태그 클래스보다는 sealed 클래스 계층으로 만드는 것이 좋다.
- imuutable 객체로 만들고, 변경할 때마다 state 프로퍼티를 변경한다.
- 뷰에서는 state 변화를 관찰한다.


